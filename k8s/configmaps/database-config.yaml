apiVersion: v1
kind: ConfigMap
metadata:
  name: database-config
  namespace: eagle-services
  labels:
    app: eagle-services
    component: database
data:
  # PostgreSQL configuration
  SPRING_DATASOURCE_URL: "jdbc:postgresql://postgres-master:5432/eagle_alerts"
  SPRING_DATASOURCE_DRIVER_CLASS_NAME: "org.postgresql.Driver"
  SPRING_DATASOURCE_PLATFORM: "postgresql"
  
  # Connection pool configuration (HikariCP)
  SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE: "20"
  SPRING_DATASOURCE_HIKARI_MINIMUM_IDLE: "5"
  SPRING_DATASOURCE_HIKARI_CONNECTION_TIMEOUT: "30000"
  SPRING_DATASOURCE_HIKARI_IDLE_TIMEOUT: "600000"
  SPRING_DATASOURCE_HIKARI_MAX_LIFETIME: "1800000"
  SPRING_DATASOURCE_HIKARI_LEAK_DETECTION_THRESHOLD: "60000"
  
  # JPA/Hibernate configuration
  SPRING_JPA_DATABASE_PLATFORM: "org.hibernate.dialect.PostgreSQLDialect"
  SPRING_JPA_HIBERNATE_DDL_AUTO: "validate"
  SPRING_JPA_SHOW_SQL: "false"
  SPRING_JPA_PROPERTIES_HIBERNATE_FORMAT_SQL: "true"
  SPRING_JPA_PROPERTIES_HIBERNATE_JDBC_BATCH_SIZE: "25"
  SPRING_JPA_PROPERTIES_HIBERNATE_ORDER_INSERTS: "true"
  SPRING_JPA_PROPERTIES_HIBERNATE_ORDER_UPDATES: "true"
  SPRING_JPA_PROPERTIES_HIBERNATE_JDBC_BATCH_VERSIONED_DATA: "true"
  
  # Read replica configuration (for analytics)
  SPRING_DATASOURCE_READONLY_URL: "jdbc:postgresql://postgres-replica:5432/eagle_alerts"
  SPRING_DATASOURCE_READONLY_HIKARI_MAXIMUM_POOL_SIZE: "10"
  SPRING_DATASOURCE_READONLY_HIKARI_MINIMUM_IDLE: "2"